{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from \"axios\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nexport default async function getImages(userImgTag, currentPage) {\n  const API_KEY = `?key=42244518-9742bcd26a7acdceb08ce98f6`;\n  const BASE_URL = 'https://pixabay.com/api/';\n  const END_POINT = `&q=${userImgTag}&image_type=photo&orientation=horizontal&safesearch=true`;\n  const url = `${BASE_URL}${API_KEY}${END_POINT}`;\n\n  const params = {\n    page: currentPage,\n    per_page: 15\n  }\n\n  try {\n    const res = await axios.get(url, { params });\n    const data = res.data;\n\n    if (data.hits && data.hits.length > 0) {\n      return data;\n    } else {\n      noImageError();\n    } \n  } catch (error) {\n    console.error(error.message);\n  }\n}\n\nconst noImageError = () => \n  iziToast.error({\n    message: 'Sorry, there are no images matching your search query. Please try again!',\n    titleColor: 'white',\n    titleSize: '16px',\n    messageColor: 'white',\n    messageSize: '16px',\n    backgroundColor: '#ef4040',\n    iconUrl: '/img/error.svg',\n    iconColor: 'white',\n    position: 'topRight',\n    maxWidth: '432px',\n  });","'use strict';\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst refs = {\n    imageElem: document.querySelector('.gallery'),\n};\n\nconst gallery = new SimpleLightbox('.gallery a', {\n    captions: true,\n    captionDelay: 250,\n    captionsData: 'alt',\n  });\n\nexport default function renderImages(pictures) {\n    const markup = pictures\n    .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n        `<li class=\"gallery-item\">\n            <a href=\"${largeImageURL}\">\n                <img src=\"${webformatURL}\" alt=\"${tags}\"\"/>\n                <div class=\"img-info\">\n                    <p class=\"info-item\"><b>Likes:</b>${likes}</p>\n                    <p class=\"info-item\"><b>Views:</b>${views}</p>\n                    <p class=\"info-item\"><b>Comments:</b>${comments}</p>\n                    <p class=\"info-item\"><b>Downloads:</b>${downloads}</p>\n                </div>\n            </a>\n        </li>`)\n    .join('');\n\n    refs.imageElem.insertAdjacentHTML('beforeend', markup);\n\n    gallery.refresh();\n};","'use strict';\n\nimport getImages from './js/pixabay-api';\nimport renderImages from './js/render-functions';\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst STORAGE_KEY = 'image-tag';\n\nconst refs = {\n    imgTagInput: document.querySelector('#search-img'),\n    searchBtn: document.querySelector('.form'),\n    imageElem: document.querySelector('.gallery'),\n    btnLoadMore: document.querySelector('.load-btn'),\n    loader: document.querySelector('.backdrop'),\n};\n\nlet userImgTag;\nlet page;\nlet maxPage;\n\nrefs.imgTagInput.addEventListener('input', onFormInput);\nrefs.searchBtn.addEventListener('submit', onSearchImg);\nrefs.btnLoadMore.addEventListener('click', onLoadMoreClick);\n\nasync function onSearchImg(evt) {\n    evt.preventDefault();\n    userImgTag = refs.imgTagInput.value.trim();\n    page = 1;\n\n    if (userImgTag === '') {\n        enterTag();\n        return false;\n    } else {\n        showLoader();\n    };\n\n    try {\n        const data = await getImages(userImgTag, page);\n        maxPage = Math.ceil(data.totalHits / 15);\n\n        refs.imageElem.innerHTML = '';\n        showImages(data.hits);\n    } catch (error) {\n        console.log(error.message);\n    }\n\n    localStorage.removeItem(STORAGE_KEY);\n    hideLoader();\n    checkBtnVisibleStatus();\n    refs.searchBtn.reset();\n}\n\nasync function onLoadMoreClick() {\n    page += 1;\n    showLoader();\n    const data = await getImages(userImgTag, page);\n    showImages(data.hits);\n\n    hideLoader();\n    checkBtnVisibleStatus();\n  \n    const height = refs.imageElem.firstElementChild.getBoundingClientRect().height;\n  \n    scrollBy({\n      behavior: 'smooth',\n      top: height * 2,\n    });\n}\n\nfunction saveToLS(key, value) {\n    const archive = JSON.stringify(value);\n    localStorage.setItem(key, archive);\n}\n\nfunction onFormInput() {\n  const tag = refs.imgTagInput.value.trim();\n\n  const data = {\n      tag,\n  };\n\n  saveToLS(STORAGE_KEY, data);\n}\n\nfunction loadFromLS(key) {\n    const archive = localStorage.getItem(key);\n\n    try {\n        return JSON.parse(archive);\n    } catch (error) {\n        console.error('Error parsing JSON from localStorage:', error);\n        return {};\n    }\n}\n\nfunction init() {\n    const data = loadFromLS(STORAGE_KEY) || {};\n    refs.imgTagInput.value = data.tag || '';\n}\n\ninit();\n\n\nfunction showImages(images) {\n    const markup = renderImages(images);\n    showLoadBtn();\n}\n\n\nfunction showLoadBtn() {\n    refs.btnLoadMore.classList.remove('hidden');\n}\n\nfunction hideLoadBtn() {\n    refs.btnLoadMore.classList.add('hidden');\n}\n  \nfunction showLoader() {\n    refs.loader.classList.add('is-open');\n}\n\nfunction hideLoader() {\n    refs.loader.classList.remove('is-open');\n}\n\nfunction checkBtnVisibleStatus() {\n    if (page >= maxPage) {\n      hideLoadBtn();\n      endAlert();\n    }\n}\n\n\nconst enterTag = () => \n    iziToast.error({\n        message: 'Please enter a search tag',\n        titleColor: 'white',\n        titleSize: '16px',\n        messageColor: 'white',\n        messageSize: '16px',\n        backgroundColor: '#ef4040',\n        iconUrl: '/img/error.svg',\n        iconColor: 'white',\n        position: 'topRight',\n    });\n\nconst endAlert = () =>\n    iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        messageSize: '16px',\n        position: 'bottomCenter',\n    });"],"names":["getImages","userImgTag","currentPage","API_KEY","BASE_URL","END_POINT","url","params","data","axios","noImageError","error","iziToast","refs","gallery","SimpleLightbox","renderImages","pictures","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","STORAGE_KEY","page","maxPage","onFormInput","onSearchImg","onLoadMoreClick","evt","enterTag","showLoader","showImages","hideLoader","checkBtnVisibleStatus","height","saveToLS","key","value","archive","loadFromLS","init","images","showLoadBtn","hideLoadBtn","endAlert"],"mappings":"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"}